name: Social-Media-Api-CI-Workflow

on: 
   pull_request:
      branches:
        - main
   push:
      branches:
         - main

jobs: 

   test:
       name: 'Run unit tests'
       defaults:
            run:
              shell: bash
               # Define the working directory for all run steps in the workflow
              working-directory: ./
       runs-on: ubuntu-latest
       steps:
       - uses: actions/checkout@v2
         name: 'Checkout repository'

       - name: 'Install Dependencies'
         run: npm install
         
       - name: 'Start the server'
         run: npm run start

   jest-test: 
          name: 'Jest Test'
          defaults:
            run:
              shell: bash
               # Define the working directory for all run steps in the workflow
              working-directory: ./
          runs-on: ubuntu-latest
          steps:
          - uses: actions/checkout@v2
            name: 'Checkout repository'
            
          - name: 'Install Dependencies'
            run: npm install

          - name: 'start testing'
            run: npm run test:ci
            
         
  
